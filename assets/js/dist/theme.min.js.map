{"version":3,"file":"theme.min.js","sources":["../../../_javascript/theme.js"],"sourcesContent":["/**\r\n * Theme management class\r\n *\r\n * To reduce flickering during page load, this script should be loaded synchronously.\r\n */\r\nclass Theme {\r\n  static #modeKey = 'mode';\r\n  static #modeAttr = 'data-mode';\r\n  static #darkMedia = window.matchMedia('(prefers-color-scheme: dark)');\r\n  static switchable = !document.documentElement.hasAttribute(this.#modeAttr);\r\n\r\n  static get DARK() {\r\n    return 'dark';\r\n  }\r\n\r\n  static get LIGHT() {\r\n    return 'light';\r\n  }\r\n\r\n  /**\r\n   * @returns {string} Theme mode identifier\r\n   */\r\n  static get ID() {\r\n    return 'theme-mode';\r\n  }\r\n\r\n  /**\r\n   * Gets the current visual state of the theme.\r\n   *\r\n   * @returns {string} The current visual state, either the mode if it exists,\r\n   *                   or the system dark mode state ('dark' or 'light').\r\n   */\r\n  static get visualState() {\r\n    if (this.#hasMode) {\r\n      return this.#mode;\r\n    } else {\r\n      return this.#sysDark ? this.DARK : this.LIGHT;\r\n    }\r\n  }\r\n\r\n  static get #mode() {\r\n    return (\r\n      sessionStorage.getItem(this.#modeKey) ||\r\n      document.documentElement.getAttribute(this.#modeAttr)\r\n    );\r\n  }\r\n\r\n  static get #isDarkMode() {\r\n    return this.#mode === this.DARK;\r\n  }\r\n\r\n  static get #hasMode() {\r\n    return this.#mode !== null;\r\n  }\r\n\r\n  static get #sysDark() {\r\n    return this.#darkMedia.matches;\r\n  }\r\n\r\n  /**\r\n   * Maps theme modes to provided values\r\n   * @param {string} light Value for light mode\r\n   * @param {string} dark Value for dark mode\r\n   * @returns {Object} Mapped values\r\n   */\r\n  static getThemeMapper(light, dark) {\r\n    return {\r\n      [this.LIGHT]: light,\r\n      [this.DARK]: dark\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Initializes the theme based on system preferences or stored mode\r\n   */\r\n  static init() {\r\n    if (!this.switchable) {\r\n      return;\r\n    }\r\n\r\n    this.#darkMedia.addEventListener('change', () => {\r\n      const lastMode = this.#mode;\r\n      this.#clearMode();\r\n\r\n      if (lastMode !== this.visualState) {\r\n        this.#notify();\r\n      }\r\n    });\r\n\r\n    if (!this.#hasMode) {\r\n      return;\r\n    }\r\n\r\n    if (this.#isDarkMode) {\r\n      this.#setDark();\r\n    } else {\r\n      this.#setLight();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Flips the current theme mode\r\n   */\r\n  static flip() {\r\n    if (this.#hasMode) {\r\n      this.#clearMode();\r\n    } else {\r\n      this.#sysDark ? this.#setLight() : this.#setDark();\r\n    }\r\n    this.#notify();\r\n  }\r\n\r\n  static #setDark() {\r\n    document.documentElement.setAttribute(this.#modeAttr, this.DARK);\r\n    sessionStorage.setItem(this.#modeKey, this.DARK);\r\n  }\r\n\r\n  static #setLight() {\r\n    document.documentElement.setAttribute(this.#modeAttr, this.LIGHT);\r\n    sessionStorage.setItem(this.#modeKey, this.LIGHT);\r\n  }\r\n\r\n  static #clearMode() {\r\n    document.documentElement.removeAttribute(this.#modeAttr);\r\n    sessionStorage.removeItem(this.#modeKey);\r\n  }\r\n\r\n  /**\r\n   * Notifies other plugins that the theme mode has changed\r\n   */\r\n  static #notify() {\r\n    window.postMessage({ id: this.ID }, '*');\r\n  }\r\n}\r\n\r\nTheme.init();\r\n\r\nexport default Theme;\r\n"],"names":["Theme","DARK","LIGHT","ID","visualState","_classPrivateGetter","_get_hasMode","_get_mode","_get_sysDark","getThemeMapper","light","dark","init","switchable","_assertClassBrand","_darkMedia","_","addEventListener","lastMode","_clearMode","call","_notify","_get_isDarkMode","_setDark","_setLight","flip","_Theme","_this","sessionStorage","getItem","_modeKey","document","documentElement","getAttribute","_modeAttr","_this2","_this3","_this4","matches","setAttribute","setItem","removeAttribute","removeItem","window","postMessage","id","matchMedia","_defineProperty","hasAttribute"],"mappings":"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"}